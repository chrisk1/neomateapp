infusiondb=[{name:"dopamine",units:"mcg/kg/min",startdose:5,fluidtype:"5d0.9ns",desiredrate:1,syringe:50,minconc:0,maxconc:80,minconcmsg:"",maxconcmsg:"Concentrations higher than 1.6 mg/ml are not recommended, unless infused centrally (BNFc 2015).",mindose:5,maxdose:20,dosemsg:"Usual dose 5-20 mcg/kg/min, <b>via central line</b>."},{name:"dobutamine",units:"mcg/kg/min",startdose:5,fluidtype:"5d0.9ns",desiredrate:1,syringe:50,minconc:0,maxconc:500,minconcmsg:"",maxconcmsg:"Concentrations higher than 10mg/ml are not commonly used (Medusa 2015)",
mindose:2,maxdose:20,dosemsg:"Usual dose 2-20 mcg/kg/min, via central line"},{name:"adrenaline",units:"ng/kg/min",startdose:100,fluidtype:"5d0.9ns",desiredrate:.1,syringe:50,minconc:0,maxconc:12,minconcmsg:"",maxconcmsg:"Infusions of >12mg in 50ml are not usually recommended (Medusa 2015).",mindose:50,maxdose:500,dosemsg:"Usual dose 50-500 nanograms/kg/min, via central line"},{name:"noradrenaline",units:"ng/kg/min",startdose:100,fluidtype:"5d0.9ns",desiredrate:.1,syringe:50,minconc:0,maxconc:2,minconcmsg:"",
maxconcmsg:"Higher than recommended concentration: max. 40 micrograms/mL (higher concentrations can be used if fluid restricted) - BNFc Jan 2015.",mindose:50,maxdose:500,dosemsg:"Usual dose 50-500 nanograms/kg/min, via central line"},{name:"dinoprostone",units:"ng/kg/min",startdose:10,fluidtype:"5d0.9ns",desiredrate:1,syringe:50,minconc:0,maxconc:.05,minconcmsg:"",maxconcmsg:"Higher than recommended concentration: BNFc recommends dilution to 1 microgram/mL.",mindose:1,maxdose:20,dosemsg:"Usual dose 5-10 nanograms/kg/min"},
{name:"morphine",units:"mcg/kg/hr",startdose:20,fluidtype:"5d0.9ns",desiredrate:1,syringe:50,minconc:0,maxconc:1500,minconcmsg:"",maxconcmsg:"Higher than recommended concentration.",mindose:0,maxdose:60,dosemsg:"Usual dose 5-20 mcg/kg/hr, but higher doses may be used."},{name:"vecuronium",units:"mcg/kg/hr",startdose:100,fluidtype:"5d0.9ns",desiredrate:1,syringe:50,minconc:4,maxconc:200,minconcmsg:"Too dilute: Do not dilute to a concentration of less than 40micrograms in 1mL. (BNF for Children January 2015)",
maxconcmsg:"Higher than recommended concentration: Dilute to an ideal maximum concentration of 2mg in 1mL. (BNF for Children January 2015)",mindose:50,maxdose:200,dosemsg:"Usual dose 50-200 mcg/kg/hr"},{name:"clonazepam",units:"mcg/kg/hr",startdose:10,fluidtype:"5d0.9ns",desiredrate:1,syringe:50,minconc:0,maxconc:.6,minconcmsg:"",maxconcmsg:"Higher than recommended concentration: Dilute to a maximum concentration of 12micrograms in 1mL. (Medusa 2015)",mindose:10,maxdose:40,dosemsg:"Usual dose 10-40 mcg/kg/hr"},
{name:"midazolam",units:"mcg/kg/hr",startdose:30,fluidtype:"5d0.9ns",desiredrate:.1,syringe:50,minconc:0,maxconc:50,minconcmsg:"",maxconcmsg:"Higher than recommended concentration of 1mg / ml (Medusa 2015; BNF).",mindose:30,maxdose:300,dosemsg:"Usual dose 10-60 mcg/kg/hr"},{name:"generic",units:"mcg/kg/hr",startdose:0,fluidtype:"5d0.9ns",desiredrate:1,syringe:50,minconc:0,maxconc:99999999,minconcmsg:"",maxconcmsg:"",mindose:0,maxdose:999999999,dosemsg:"<br>Please check units <b>carefully</b>."},{name:"daily",
units:"mg/kg/day",startdose:0,fluidtype:"5d0.9ns",desiredrate:1,syringe:50,minconc:0,maxconc:99999999,minconcmsg:"",maxconcmsg:"",mindose:0,maxdose:999999999,dosemsg:"<br>Please check units <b>carefully</b>."}];var gramsnotification="",weighthistory="",appversion="3.1.3",appdate="October 2017",devicemodel="";document.addEventListener("deviceready",onDeviceReady,!1);function trackAppLoad(){console.log("Triggered app load");trackPage("Start page");console.log("Track app load")}
function trackMenuOpen(b){console.log("Triggered menu open");console.log("Track menu open: "+b);"undefined"!==typeof ga&&window.ga.trackEvent(b+"-"+$("#babyweight").val(),"Click")}function trackPage(b){console.log("Triggered pageview - "+b);"undefined"!==typeof ga&&window.ga.trackView(b)}
function handleExternalURLs(){if("ANDROID"===device.platform.toUpperCase())$(document).on("click",'a[href^="http"]',function(b){var a=$(this).attr("href");navigator.app.loadUrl(a,{openExternal:!0});b.preventDefault()});else if("IOS"===device.platform.toUpperCase())$(document).on("click",'a[href^="http"]',function(b){var a=$(this).attr("href");window.open(a,"_system");b.preventDefault()})}$("#surveyform").submit(function(){Keyboard.hide();return!1});
$("#babyweight").submit(function(){Keyboard.hide();return!1});$(".backicon").click(function(){$.mobile.back()});$(".backtohomeicon").click(function(){$.mobile.changePage("#main");$.mobile.silentScroll(0)});$(".contactchris").click(function(){console.log("Contact link clicked");window.open("mailto:chris.kelly@doctors.org.uk","_system")});
function onDeviceReady(){console.log("Device on ready launched");FastClick.attach(document.body);console.log("initializeGAplugin");window.ga.startTrackerWithId("UA-54184908-2",5);window.ga.setAppVersion(appversion);window.ga.setUserId(checkUUID());trackAppLoad();window.device||(window.device={platform:"Browser"});handleExternalURLs();AppRate.preferences.storeAppURL.ios="944319462";AppRate.preferences.storeAppURL.android="market://details?id=com.incubateltd.neomate";AppRate.preferences.openStoreInApp=
!1;AppRate.preferences.displayAppName="NeoMate";AppRate.preferences.usesUntilPrompt=1;AppRate.preferences.promptAgainForEachNewVersion=!0;AppRate.preferences.customLocale={title:"Rate NeoMate",message:"If you find NeoMate helpful, would you mind taking a moment to rate it? Thank you for your support!",cancelButtonLabel:"No, Thanks",laterButtonLabel:"Remind Me Later",rateButtonLabel:"Yes"};localStorage.getItem("countBabyLoad");var b=initialisetests();console.log(b);"pass"==b[0]?$("#teststatus").html("<b>Internal tests completed:</b><br>Last performed: "+
b[4]+"<br>Success on all unit tests during app launch. Drug dose calculation framework working as expected.<br><br>"):"fail"==b[0]&&($("#teststatus").html("<b>Internal tests completed:</b><br>Last performed: "+b[4]+"<br><b>FAILURE</b> on "+b[2]+" of "+b[1]+" unit tests during app launch.<br>Detailed test failure info: "+b[3]+" <br><br>"),navigator.splashscreen.hide(),$("#detailedtestinfopanel").html("Time performed: "+b[4]+"<br><b>FAILURE</b> on "+b[2]+" of "+b[1]+" unit tests during app launch.<br><br>Detailed test failure info: <br>"+
b[3]+"<br><br>App version: "+appversion+"<br><br>"),$.mobile.changePage("#testfailure"),window.ga.trackException(b[2]+"/"+b[1]+" failed. V"+appversion+". "+b[3],!0));navigator.userAgent.match(/Android/)?setTimeout(function(){navigator.splashscreen.hide()},30):setTimeout(function(){$(".numericalinput").attr("type","number");navigator.splashscreen.hide()},30);window.scrollTo(0,1);setTimeout(function(){$.mobile.resetActivePageHeight()},100);StatusBar.show();StatusBar.styleBlackTranslucent();StatusBar.backgroundColorByHexString("#232323")}
function showMessage(b,a,c,d){c=c||"default title";d=d||"OK";if(navigator.notification&&navigator.notification.alert)navigator.notification.alert(b,a,c,d);else{if("qunit"==$.mobile.activePage.attr("id"))throw b;alert(b);a()}}function scrollToAnchor(b){b=$("a[name='"+b+"']");$("html,body").animate({scrollTop:b.offset().top},"slow")}
function babyCounter(){var b=localStorage.getItem("countBabyLoad");null==b?(localStorage.setItem("countBabyLoad",1),console.log("Baby counter: First baby")):(b=Number(b)+1,localStorage.setItem("countBabyLoad",b),console.log("Baby counter: baby number: "+b))}
function neomateUUID(){var b=localStorage.getItem("neomateuuid");null==b||40<b.length?(console.log("Creating new UUID..."),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)}),localStorage.setItem("neomateuuid",b),console.log("New UUID created: "+b)):console.log("Existing UUID: "+b)}
function checkUUID(){var b=localStorage.getItem("neomateuuid");if(null==b)console.log("Creating new UUID..."),localStorage.setItem("neomateuuid","xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)}));else return b}$(".checkbox-link").bind("tap click",function(b,a){b.stopPropagation();b.preventDefault();var c=$(this).find("a:first").attr("href");$.mobile.changePage(c)});
$(".checkbox-link-external").bind("tap click",function(b,a){b.stopPropagation();b.preventDefault();var c=$(this).find("a:first").attr("href");window.open(c,"_system")});$("#checklists").on("pageshow",function(b){$("#checklists>div>ul>li.ui-btn-active").removeClass("ui-btn-active");20<localStorage.getItem("countBabyLoad")&&setTimeout(function(){AppRate.promptForRating(!1)},2E3)});$("#reference").on("pageshow",function(b){$("#reference>div>ul>li.ui-btn-active").removeClass("ui-btn-active")});
$('div[id^="checklist"]').on("pageshow",function(){$(".backbtn").removeClass("ui-btn-active")});
$("#survey").on("pageshow",function(b){"unknown"!=localStorage.getItem("surveyemail")&&$("#surveyemail").val(localStorage.getItem("surveyemail"));"unknown"!=localStorage.getItem("surveyfeedback")&&$("#surveyfeedback").val(localStorage.getItem("surveyfeedback"));$("#surveycountry").val(localStorage.getItem("surveycountry")).selectmenu("refresh");$("#surveyrole").val(localStorage.getItem("surveyrole")).selectmenu("refresh");$("#surveyexperience").val(localStorage.getItem("surveyexperience")).selectmenu("refresh")});
$('div[id^="pop"]').on("pageshow",function(){$(".backbtn").removeClass("ui-btn-active")});$("#estimatelabel").click(function(){$.mobile.changePage("#weightinfobox")});$(".estweightlink").click(function(){var b=$(this).data("weight");$.mobile.changePage("#main");$("#babyweight").val(b);CalculateApp();$("#babyweight").trigger("change")});
$("#diagnostics").click(function(){var b=localStorage.getItem("countAppLoad"),a=localStorage.getItem("countBabyLoad");showMessage("Debug mode: Load: "+b+", Baby: "+a+", Device version: "+device.version+", User agent: "+navigator.userAgent,!1,"Diagnostic Info","Back")});$("#resetcookie").click(function(){localStorage.clear();console.log("Cleared localStorage");showMessage("Debug mode: localStorage cleared",!1,"Diagnostic Info","Back")});
$("#oimapunits").click(function(){"cmH2O"==$("input[name=oimapunits]:checked").val()?($("#oimapunits-b").prop("checked",!0).checkboxradio("refresh"),$("#oimapunits-a").prop("checked",!1).checkboxradio("refresh"),$("#oimapunits").html("mmHg <img src='images/penpaper.png' class='infobtn' />"),OICalc()):"mmHg"==$("input[name=oimapunits]:checked").val()&&($("#oimapunits-a").prop("checked",!0).checkboxradio("refresh"),$("#oimapunits-b").prop("checked",!1).checkboxradio("refresh"),$("#oimapunits").html("cmH<sub>2</sub>O <img src='images/penpaper.png' class='infobtn' />"),
OICalc())});
$("#oippo2units").click(function(){"kPa"==$("input[name=oipao2units]:checked").val()?($("#oipao2units-a").prop("checked",!1).checkboxradio("refresh"),$("#oipao2units-b").prop("checked",!0).checkboxradio("refresh"),$("#oippo2units").html("mmHg <img src='images/penpaper.png' class='infobtn' />"),OICalc()):"mmHg"==$("input[name=oipao2units]:checked").val()&&($("#oipao2units-a").prop("checked",!0).checkboxradio("refresh"),$("#oipao2units-b").prop("checked",!1).checkboxradio("refresh"),$("#oippo2units").html("kPa <img src='images/penpaper.png' class='infobtn' />"),OICalc())});
function highlightWeight(){if(.4>$("#babyweight").val()/1E3||""==$("#babyweight").val())scrollToAnchor("maintop"),$("#babyweight").focus(),$("#babyweight").parent().addClass("flash"),setTimeout(function(){$("#babyweight").parent().removeClass("flash");400>$("#babyweight").val()&&$("#babyweight").parent().addClass("texthighlight")},5E3)}function nativePluginResultHandler(){console.log("Track success")}function nativePluginErrorHandler(){console.log("Track fail")}
var unittestcount=0,unittestfailcount=0,unittestfailsummary="",unittestsummary="pass";function unittest(b,a,c){unittestcount+=1;if(b==a)return!0;unittestfailcount+=1;commentdetail="<b>ERROR:</b> "+c+" (<b>expected:</b> "+a+", <b>observed:</b> "+b+")";unittestfailsummary=""==unittestfailsummary?commentdetail:unittestfailsummary+", <br>"+commentdetail;unittestsummary="fail";return!1}
function initialisetests(){function b(a,b){var c="000000000"+a;return c.substr(c.length-b)}$("#babyweight").val(1E3);CalculateApp();unittest($("#babyweight").val(),1E3,"Weight input set to 1kg");unittest($("#uvcdetails").text(),"Size: 3.5 FLength: 7 cm (plus stump length)L = (1.5 x birthweight [kg]) + 5.5","UVC Size: 3.5 F, Length: 7 cm (plus stump length), L = (1.5 x birthweight [kg]) + 5.5");unittest($("#uacdetails").text(),"Size: 3.5 FLength: 12 cm (plus stump length)L = (birthweight [kg] x 3) + 9",
"UAC Size: 3.5 F, Length: 12 cm (plus stump length), L = (birthweight [kg] x 3) + 9");unittest($("#naclbolus").text(),"10 ml over 20-30 minutes, via IV/UVC","Sodium chloride bolus 10 ml over 20-30 minutes");unittest($("#dopamineinfusion").text(),"30 mg added to 50 ml of 0.9% NaCl or 5% dextrose.1 ml/hr will deliver 10 micrograms/kg/min.","Dopamine 30 mg added to 50 ml of 0.9% NaCl or 5% dextrose. 1 ml/hr will deliver 10 micrograms/kg/min.");unittest($("#dobutamineinfusion").text(),"30 mg added to 50 ml of 0.9% NaCl or 5% dextrose.1 ml/hr will deliver 10 micrograms/kg/min. ",
"Dobutamine infusion 30 mg added to 50 ml of 0.9% NaCl or 5% dextrose. 1 ml/hr will deliver 10 micrograms/kg/min. Max concentration 250mg in 50ml.");unittest($("#adrenalineinfusion").text(),"3 mg added to 50 ml of 0.9% NaCl or 5% dextrose.0.1 ml/hr will deliver 100 nanograms/kg/min.","3 mg added to 50 ml of 0.9% NaCl or 5% dextrose.0.1 ml/hr will deliver 100 nanograms/kg/min.");unittest($("#noradrenalineinfusion").text(),"3 mg added to 50 ml of 0.9% NaCl or 5% dextrose.0.1 ml/hr will deliver 100 nanograms/kg/min.",
"Noradrenaline infusion 3 mg added to 50 ml of 0.9% NaCl or 5% dextrose. 0.1 ml/hr will deliver 100 nanograms/kg/min.");unittest($("#protine2").text(),"15 micrograms added to 50 ml of 0.9% NaCl or 5% dextrose.1 ml/hr will deliver 5 nanograms/kg/min.","Dinoprostone infusion 15 micrograms added to 50 ml of 0.9% NaCl or 5% dextrose. 1 ml/hr will deliver 5 nanograms/kg/min.");unittest($("#uvcdetails2").text(),"Size: 3.5 FLength: 7 cm (plus stump length)L = (1.5 x birthweight [kg]) + 5.5","UVC details: Size: 3.5, F Length: 7 cm (plus stump length), L = (1.5 x birthweight [kg]) + 5.5");
unittest($("#uacdetails2").text(),"Size: 3.5 FLength: 12 cm (plus stump length)L = (birthweight [kg] x 3) + 9","UAC details: Size: 3.5, F Length: 12 cm (plus stump length), L = (birthweight [kg] x 3) + 9");unittest($("#fentanylbolus2").text(),"5 micrograms by slow IV push(preferred drug for intubation)","Fentanyl bolus 5 micrograms by slow IV push (preferred drug for intubation)");unittest($("#morphinebolus2").text(),"100 micrograms by slow IV push","Morphine bolus 100 micrograms by slow IV push");
unittest($("#vecuroniumbolus").text(),"100 micrograms by slow IV push(for short duration of action)","Vecuronium bolus 100 micrograms by slow IV push (for short duration of action)");unittest($("#pancuroniumbolus").text(),"100 micrograms by slow IV push(for longer duration of action)","Pancuronium bolus 100 micrograms by slow IV push (for longer duration of action)");unittest($("#morphinesedativeinfusion").text(),"1 mg added to 50 ml of 0.9% NaCl or 5% Dextrose. 1 ml/hr will deliver 20 micrograms/kg/hr.",
"1 mg added to 50 ml of 0.9% NaCl or 5% Dextrose. 1 ml/hr will deliver 20 micrograms/kg/hr.");unittest($("#vecuroniumsedativeinfusion").text(),"5 mg added to 50 ml of 0.9% NaCl or 5% Dextrose. 1 ml/hr will deliver 100 micrograms/kg/hr.","5 mg added to 50 ml of 0.9% NaCl or 5% Dextrose. 1 ml/hr will deliver 100 micrograms/kg/hr.");unittest($("#phenobarbitoneloading").text(),"20 mg given IV over 20 minutes","Phenobarbitone loading dose 20 mg given IV over 20 minutes");unittest($("#phenytoinloading").text(),
"18 mg given IV over 30 min(needs close ECG monitoring)","Phenytoin loading dose 18 mg to be given over 30 min (needs close ECG monitoring)");unittest($("#diazepam").text(),"300 micrograms(given IV over 5 min)","Diazepam bolus 300 micrograms (IV injection over 5 min)");unittest($("#midazolaminfusion").text(),"15 mg added to 50 ml 0.9% NaCl or 5% dextrose.0.1 ml/hr will deliver 30 micrograms/kg/hour.","Midazolam infusion 15 mg added to 50 ml 0.9% NaCl or 5% dextrose. 0.1 ml/hr will deliver 30 micrograms/kg/hour.");
unittest($("#adrenalineemergency").text(),"1st dose at 0.1 ml/kg= 0.1 ml IV stat.Flush with 0.9% sodium chloride.2nd dose at 0.3 ml/kg= 0.3 ml IV stat.Flush with 0.9% sodium chloride.","Adrenaline stat dose 0.1/0.3 ml - correct");unittest($("#dextrosebolus").text(),"2.5 ml over 20-30 minutes, via UVC or IV.","Dextrose 2.5 ml over 20-30 mins - correct");unittest($("#sodiumbicarb").text(),"2 ml (=1 mmol) of sodium bicarbonate 4.2% for use during emergency resuscitation, given via UVC","Sodium bicarbonate emergency drug dose - correct");
unittest($("#adenosine").text(),"150 micrograms IV stat into a large central vein and followed immediately by NaCl 0.9% push.","Adenosine dose 50mg IV stat - correct");unittest($("#insulin").text(),"2 units added to 20 ml 5% dextrose.0.1 ml/hr will deliver 0.01 units/kg/hour, given IV as an infusion. Flush 5 ml through giving set before connecting.","Insulin infusion details correct");unittest($("#benpen").text(),"50 mg IV (BD/TDS depending on age)","Benzylpenicillin dose 25mg/kg or 50mg/kg");unittest($("#gentamicin").text(),
"5 mg IV. Check level before 3rd dose.","5 mg 36 hourly IV. Check level before 3rd dose.");unittest($("#fluids").text(),"60 ml daily over 24 hours= 2.5 ml/hour infusion","10% dextrose: 60 ml daily over 24 hours = 2.5 ml/hour infusion");unittest($("#vitk").text(),"0.4 mg IM","Vitamin K: 0.4 mg IM");$("#fluidsvalue").val("");$("#dextrosefluid").val("10");$("#tisodium").val("0");$("#tipotassium").val("0");unittest($("#naclbolus2").text(),"10 ml over 20-30 minutes","Sodium chloride 0.9% bolus: 10 ml over 20-30 minutes");
unittest($("#dextrosebolus2").text(),"2.5 ml over 20-30 minutes","Dextrose 10% bolus: 2.5 ml over 20-30 minutes");$("#fluidsvalue").val("");$("#dextrosefluid").val("10");$("#tisodium").val("0");$("#tipotassium").val("0");$("#fluidsvalue").val(60);CalculateApp();unittest($("#fluidsvalue").val(),60,"Fluid input set to 60 ml/kg/day");unittest($("#fluidoutput").text(),"Daily total fluid requirement= 60 ml/day, or 2.5 ml/hour.= 4.2 mg/kg/min glucose infusion rate PreparationTake a 500ml bag of 10% dextrose. ",
"Daily total fluid requirement= 60 ml/day, or 2.5 ml/hour. Glucose infusion rate = 4.2 mg/kg/min. Preparation: Take a 500ml bag of 10% dextrose. ");$("#fluidsvalue").val(60);$("#tisodium").val(2);$("#tipotassium").val(2);CalculateApp();unittest($("#fluidsvalue").val(),60,"Fluid input set to 60 ml/kg/day. 2mmol of sodium and potassium");unittest($("#fluidoutput").text(),"Daily total fluid requirement= 60 ml/day, or 2.5 ml/hour.= 4.2 mg/kg/min glucose infusion rate PreparationTake a 500ml bag of 10% dextrose. Add:16.7 mmol sodium chloride(or add 1.3 mmol NaCl if using 10% dextrose + 0.18% saline, as a bag already contains 15.4 mmol sodium)16.7 mmol potassium chloride",
"Fluids with 2mmol of sodium/potassium: Daily total fluid requirement= 60 ml/day, or 2.5 ml/hour. Glucose infusion rate = 4.2 mg/kg/min. Take a 500ml bag of 10% dextrose. Add 16.7 mmol sodium chloride (or add 1.3 mmol NaCl if using 10% dextrose + 0.18% saline, as a bag already contains 15.4 mmol sodium), add 16.7 mmol potassium chloride.");$("#fluidsvalue").val(90);$("#dextrosefluid").val(15);$("#tisodium").val(0);$("#tipotassium").val(0);CalculateApp();unittest($("#fluidsvalue").val(),90,"Fluid input set to 90 ml/kg/day. Dextrose concentration set to 15%. No sodium or potassium.");
unittest($("#fluidoutput").text(),"Daily total fluid requirement= 90 ml/day, or 3.8 ml/hour.= 9.5 mg/kg/min glucose infusion rate Administration routeInfuse via central line (dextrose concentration > 12.5%).PreparationTake a 500ml bag of 10% dextrose, remove 62.5 ml and add 62.5 ml of 50% dextrose. ","Dextrose 15%: Daily total fluid requirement= 90 ml/day, or 3.8 ml/hour. Glucose infusion rate = 9.5 mg/kg/min. Administration route: Infuse via central line (dextrose concentration > 12.5%). PreparationTake a 500ml bag of 10% dextrose, remove 62.5 ml and add 62.5 ml of 50% dextrose.");
var a="dopamine",c=infusiondb.filter(function(b){return b.name==a})[0],d=new Infusion(c.name,10,c.units,c.desiredrate,1E3,c.syringe,c.fluidtype,0,c.dosemsg,c.minconc,c.maxconc,c.minconcmsg,c.maxconcmsg,c.mindose,c.maxdose,c.units);unittest(d.outputtext(),"30 mg added to 50 ml of 0.9% NaCl or 5% dextrose. <br>1 ml/hr will deliver 10 micrograms/kg/min.","Dopamine infusion calc: outputtext()");unittest(d.maxconcmsg,"Concentrations higher than 1.6 mg/ml are not recommended, unless infused centrally (BNFc 2015).",
"Dopamine infusion calc: maxconcmsg true");d=new Infusion(c.name,10,c.units,.1,1E3,c.syringe,c.fluidtype,0,c.dosemsg,c.minconc,c.maxconc,c.minconcmsg,c.maxconcmsg,c.mindose,c.maxdose,c.units);unittest(d.advisorymsg,"Infusion concentration is 6 mg/ml. Concentrations higher than 1.6 mg/ml are not recommended, unless infused centrally (BNFc 2015).","Dopamine high concentration warning given.");a="adrenaline";c=infusiondb.filter(function(b){return b.name==a})[0];d=new Infusion(c.name,100,c.units,c.desiredrate,
1E3,c.syringe,c.fluidtype,0,c.dosemsg,c.minconc,c.maxconc,c.minconcmsg,c.maxconcmsg,c.mindose,c.maxdose,c.units);unittest(d.outputtext(),"3 mg added to 50 ml of 0.9% NaCl or 5% dextrose. <br>0.1 ml/hr will deliver 100 nanograms/kg/min.","Adrenaline infusion calc: outputtext()");$("#babyweight").val("");$("#fluidsvalue").val("");$("#dextrosefluid").val("10");$("#tisodium").val("0");$("#tipotassium").val("0");CalculateApp();c=new Date;c=b(c.getDate(),2)+"/"+b(c.getMonth()+1,2)+"/"+c.getFullYear()+" @ "+
b(c.getHours(),2)+":"+b(c.getMinutes(),2)+":"+b(c.getSeconds(),2);return[unittestsummary,unittestcount,unittestfailcount,unittestfailsummary,c]}
navigator.userAgent.match(/Android/)&&($(document).ready(function(){$("#fluidsvalue").clone().attr("type","number").insertAfter("#fluidsvalue").prev().remove();$("#oimap").clone().attr("type","number").insertAfter("#oimap").prev().remove();$("#oippo2").clone().attr("type","number").insertAfter("#oippo2").prev().remove()}),$("#decoy1").show(),$("#decoy2").show(),$("#oidecoy2").show());$("#decoy1").hide();$("#decoy2").hide();$("#oidecoy3").hide();
$(document).one("pagebeforechange",function(){function b(a){a.one("expand",function(){0<$("#main").find(".ui-collapsible-collapsed").length&&0==$("#main").find(".ui-footer-fixed").is(":visible")&&$("[data-position='fixed']").fixedtoolbar("show");$(this).parent().find(".ui-collapsible-content").slideUp(300);$(this).parent().parent().find(".maintitle-weight").text("");400<=$("#babyweight").val()&&7E3>=$("#babyweight").val()&&$(this).find(".maintitle-weight").text("for "+$("#babyweight").val()+"g");
$(this).find(".ui-collapsible-content").slideDown(300,function(){b($(this).parent().trigger("expand"));var a=$(this).parent().offset().top-49;console.log("Expandabletop: "+a);$window=$(window);targetPos=a-$window.scrollTop()+$(this).parent().height();console.log("Targetpos: "+targetPos);40<a|500<targetPos&&(console.log("Scrolling to menu icon"),$("html,body").animate({scrollTop:a},"slow"));trackMenuOpen($(this).parent().find(".ui-btn-text").text().replace(" click to collapse contents",""))});return!1}).one("collapse",
function(){0<$("#main").find(".ui-collapsible-collapsed").length&&0==$("#main").find(".ui-footer-fixed").is(":visible")&&$("[data-position='fixed']").fixedtoolbar("show");$(this).find(".maintitle-weight").text("");1==$(this).parent().find(".ui-icon-back").length?$(this).find(".ui-collapsible-content").slideUp(300,function(){$(this).parent().trigger("collapse")}):$(this).find(".ui-collapsible-content").slideUp(300,function(){1<$(window).scrollTop()&&$("html,body").animate({scrollTop:0},"slow");$(this).parent().trigger("collapse")});
return!1})}b($("[data-role='collapsible-set'] > [data-role='collapsible']"))});$(".drugtable tr:even").css("background-color","#F7EAEA");$(".alternatingcolor tr:even").css("background-color","#F7EAEA");$(".infusionheader").css("background-color","#CE6563");$("#popett h2").click(function(){$("#popett").dialog("close")});$("#weightinfobox h2").click(function(){$("#weightinfobox").dialog("close")});
$(function(){var b=localStorage.getItem("countAppLoad");null==b?(localStorage.setItem("countAppLoad",1),console.log("Counter: First load")):(b=Number(b)+1,localStorage.setItem("countAppLoad",b),console.log("Counter: Load number: "+b));babyCounter();neomateUUID();2!=localStorage.getItem("surveysync")&&1!=localStorage.getItem("surveysync")||ProcessSurvey("delayed");null==localStorage.getItem("neodisc30")&&(navigator.userAgent.match(/Android/)?($.mobile.changePage("#splashscreen",{}),console.log("Android splash")):
($.mobile.changePage("#splashscreen",{transition:"none"}),console.log("Non-Android splash")),localStorage.setItem("neodisc30","true"));$(".appversioninsert").text(appversion);$(".appdateinsert").text(appdate);$("#main").on("pageshow",function(a){navigator.userAgent.match(/android/i);navigator.userAgent.match(/(ipod|ipad|iphone)/i)&&$(".numericalinput").attr("type","number")});$("#survey").on("pageshow",function(a){$("#surveyform").show()});$("ul.checklistulclick li").bind("click",function(){$.mobile.changePage($(this).find("a").attr("href"),
{transition:"none",reverse:!1,changeHash:!0});trackPage("checklists-"+$(this).find("a").attr("href"))});$(function(){$("[data-role=header],[data-role=footer]").fixedtoolbar({tapToggle:!1})});$("#inputunits").children().click(function(){$("#babyweight").focus()});$(".outputvalue").click(function(){highlightWeight()});$(".othertools").click(function(){highlightWeight()});$(".drugtable").click(function(){highlightWeight()});$("#ivfluidspanel").click(function(){highlightWeight()});$("#babyweight, #fluidsvalue, #dextrosefluid, #tisodium, #tipotassium").on("change keyup input",
_.debounce(function(){CalculateApp()},0));$("#oifio2, #oimap, #oippo2").on("change keyup input",_.debounce(function(){OICalc()},0));$("input[name='oimapunits']").on("change mousedown",function(a,b){OICalc()});$("input[name='oipao2units']").on("change mousedown",function(a,b){OICalc()});$("input[type='number']").each(function(a,b){b.type="text";b.onfocus=function(){this.type="number"};b.onblur=function(){this.type="text"}});$(".ui-content").on("click",".ui-icon-delete",function(a){$("#fluidsvalue").val("");
$("#dextrosefluid").val("10").slider("refresh");$("#tisodium").val("0").slider("refresh");$("#tipotassium").val("0").slider("refresh");$("input[type='radio']").attr("checked",!0).checkboxradio("refresh");$("input[type='radio']").attr("checked",!1).checkboxradio("refresh");babyCounter();$("input[type='checkbox']").prop("checked",!1).checkboxradio().checkboxradio("refresh");$("#main").find(".maintitle-weight").text("");$(".ui-collapsible-content").trigger("collapse");$("#estimatelabel").show()});$("#surveysubmitbtn").click(function(a){$("#surveystatus").html('Sending - please wait... <img src="images/spinner20px.svg">');
ProcessSurvey("submit")})});
var ProcessSurvey=function(b){var a=navigator.userAgent;if("submit"==b){console.log("Live submit");surveyemail=0===$("#surveyemail").val().length?"unknown":$("#surveyemail").val();surveyfeedback=0===$("#surveyfeedback").val().length?"none":$("#surveyfeedback").val();surveycountry=null==$("#surveycountry").val()?"unknown":$("#surveycountry").val();surveyrole=null==$("#surveyrole").val()?"unknown":$("#surveyrole").val();surveyexperience=null==$("#surveyexperience").val()?"unknown":$("#surveyexperience").val();
a=navigator.userAgent;if(null==a||""==a)a="unknown";localStorage.setItem("surveyemail",surveyemail);localStorage.setItem("surveycountry",surveycountry);localStorage.setItem("surveyrole",surveyrole);localStorage.setItem("surveyexperience",surveyexperience);localStorage.setItem("surveyfeedback",surveyfeedback);var c={uuid:checkUUID(),surveyemail:surveyemail,surveycountry:surveycountry,surveyrole:surveyrole,surveyexperience:surveyexperience,surveyfeedback:surveyfeedback,surveydevice:a,surveyversion:appversion,
surveyip:"unknown",surveybabies:localStorage.getItem("countBabyLoad"),submittype:"live"}}else if("delayed"==b)if(console.log("Delayed submit"),2==localStorage.getItem("surveysync")||1==localStorage.getItem("surveysync")){surveyemail=null==localStorage.getItem("surveyemail")||""==localStorage.getItem("surveyemail")?"unknown":localStorage.getItem("surveyemail");surveyfeedback=null==localStorage.getItem("surveyfeedback")||""==localStorage.getItem("surveyfeedback")?"unknown":localStorage.getItem("surveyfeedback");
surveycountry=null==localStorage.getItem("surveycountry")||""==localStorage.getItem("surveycountry")?"unknown":localStorage.getItem("surveycountry");surveyrole=null==localStorage.getItem("surveyrole")||""==localStorage.getItem("surveyrole")?"unknown":localStorage.getItem("surveyrole");surveyexperience=null==localStorage.getItem("surveyexperience")||""==localStorage.getItem("surveyexperience")?"unknown":localStorage.getItem("surveyexperience");a=navigator.userAgent;if(null==a||""==a)a="unknown";c=
{uuid:checkUUID(),surveyemail:surveyemail,surveycountry:surveycountry,surveyrole:surveyrole,surveyexperience:surveyexperience,surveyfeedback:surveyfeedback,surveydevice:a,surveyversion:appversion,surveyip:"unknown",surveybabies:localStorage.getItem("countBabyLoad"),submittype:"delayed"}}else c={uuid:checkUUID(),surveyemail:"unknown",surveycountry:"unknown",surveyrole:"unknown",surveyexperience:"unknown",surveyfeedback:"unknown",surveydevice:a,surveyversion:appversion,surveyip:"unknown",surveybabies:localStorage.getItem("countBabyLoad"),
submittype:"startup"};console.log(c);$.ajax({type:"GET",url:"https://zj49kbd1s1.execute-api.eu-west-2.amazonaws.com/prod/NeoMateStore",data:c,dataType:"json",encode:!0,success:function(a){console.log(a);$("#surveystatus").html('<div class="ui-icon ui-icon-check" style="float:left; margin-right: 10px"></div>Your answers have been sent - thank you!');$("#surveystatus").addClass("statussuccess");$("#surveysubmitbtn").parent().hide();localStorage.setItem("surveysync",1);"submit"==b&&setTimeout(function(){$.mobile.changePage("#main",
{transition:"none",reverse:!1,changeHash:!0})},3E3)},error:function(a,c,l){$("#surveystatus").html('<div class="ui-icon ui-icon-check" style="float:left; margin-right: 10px"></div>Saved - thank you!');$("#surveystatus").addClass("statussuccess");$("#surveysubmitbtn").parent().hide();localStorage.setItem("surveysync",2);"submit"==b&&setTimeout(function(){$.mobile.changePage("#main",{transition:"none",reverse:!1,changeHash:!0})},3E3)}})},OICalc=function(){var b=$("#oifio2").val(),a=$("#oimap").val(),
c=$("#oippo2").val();"cmH2O"==$("input[name=oimapunits]:checked").val()?$("#oimapunits").html("cmH<sub>2</sub>O <img src='images/penpaper.png' class='infobtn' />"):"mmHg"==$("input[name=oimapunits]:checked").val()?(a/=.735559121015,$("#oimapunits").html("mmHg <img src='images/penpaper.png' class='infobtn' />")):($("#oimapunits").html("cmH<sub>2</sub>O <img src='images/penpaper.png' class='infobtn' />"),$("#oimapunits-a").prop("checked",!0).checkboxradio("refresh"));"kPa"==$("input[name=oipao2units]:checked").val()?
($("#oippo2units").html("kPa <img src='images/penpaper.png' class='infobtn' />"),c*=7.5):"mmHg"==$("input[name=oipao2units]:checked").val()?$("#oippo2units").html("mmHg <img src='images/penpaper.png' class='infobtn' />"):($("#oippo2units").html("kPa <img src='images/penpaper.png' class='infobtn' />"),$("#oipao2units-a").prop("checked",!0).checkboxradio("refresh"));a=b*a/c;""!=b&&""!=c?($("#oicontainer").show(),$("#oioutput").html("<strong>Oxygenation index = "+Math.round(10*a)/10+"</strong>"),25>
a?$("#oicontainer").css("background-color","#E5F3E5"):25<=a&&30>a?$("#oicontainer").css("background-color","#FBE1B5"):($("#oicontainer").css("background-color","#FFBEBE"),$("#oioutput").html("<strong>Oxygenation index = "+Math.round(a)+"</strong><br><br><strong>Warning</strong>: Oxygenation index is &gt;30. Consider discussing this case with your local ECMO centre."))):$("#oicontainer").hide()},CalculateApp=function(){function b(){}var a=$("#babyweight").val()/1E3;Math.round($("#babyweight").val())!=
$("#babyweight").val()&&""==gramsnotification&&(showMessage("Baby weight should be in grams!",highlightWeight,"Oops - please check entries","Done"),console.log("Baby weight should be in grams!"),highlightWeight,gramsnotification=1,a="");if(7<a)throw a!=localStorage.getItem("babyweightalert")&&(showMessage("This app is only valid for babies on NICU. Please check your weight and try again.",highlightWeight,"Oops - please check weight","Done"),localStorage.setItem("babyweightalert",a)),console.log("Baby too large"),
"Baby too large";400<=$("#babyweight").val()&&7E3>=$("#babyweight").val()?($("#main").find(".ui-icon-back").parent().find(".maintitle-weight").text("for "+$("#babyweight").val()+"g"),$("#estimatelabel").hide()):($("#main").find(".maintitle-weight").text(""),$("#estimatelabel").show());$("input[type='checkbox']").prop("checked",!1).checkboxradio().checkboxradio("refresh");$("#fentanylbolus").html(Math.round(5*a)+" micrograms by slow IV push<br>(preferred drug for intubation)");$("#morphinebolus").html(Math.round(100*
a)+" micrograms by slow IV push<br>(nb onset of action approx 5 mins; peak action at 15 - 30 mins)");$("#suxbolus").text(Math.round(2*a)+" mg by slow IV push");$("#atropinebolus").text(Math.round(20*a)+" micrograms by slow IV push");$("#curosurf").html("<b>First dose: </b>"+Math.round(200*a)+" mg,<br><b>Second dose: </b>"+Math.round(100*a)+" mg (if indicated)<br>Give via ET tube.<br>Practical note: use whole vial closest to calculated dose.");1>a&&$("#ettsize").text("2.5");1<=a&&2>a&&$("#ettsize").text("3.0");
2<=a&&3>a&&$("#ettsize").text("3.5");3<=a&&$("#ettsize").text("3.5 - 4.0");.5>a&&$("#ettlength").text("5.5 cm");.5<=a&&.7>a&&$("#ettlength").text("5.5 cm");.7<=a&&.9>a&&$("#ettlength").text("6.0 cm");.9<=a&&1.1>a&&$("#ettlength").text("6.5 cm");1.1<=a&&1.5>a&&$("#ettlength").text("7.0 cm");1.5<=a&&1.9>a&&$("#ettlength").text("7.5 cm");1.9<=a&&2.5>a&&$("#ettlength").text("8.0 cm");2.5<=a&&3.2>a&&$("#ettlength").text("8.5 cm");3.2<=a&&$("#ettlength").text("9.0 cm");$("#naclbolus").text(Math.round(10*
a)+" ml over 20-30 minutes, via IV/UVC");$("#dopamineinfusion").html(Math.round(300*a)/10+" mg added to 50 ml of 0.9% NaCl or 5% dextrose.<br>1 ml/hr will deliver 10 micrograms/kg/min.");var c=Math.round(300*a)/10;250<c&&(c=250);$("#dobutamineinfusion").html(c+" mg added to 50 ml of 0.9% NaCl or 5% dextrose.<br>1 ml/hr will deliver 10 micrograms/kg/min. ");$("#adrenalineinfusion").html(Math.round(30*a)/10+" mg added to 50 ml of 0.9% NaCl or 5% dextrose.<br>0.1 ml/hr will deliver 100 nanograms/kg/min.");
$("#noradrenalineinfusion").html(Math.round(30*a)/10+" mg added to 50 ml of 0.9% NaCl or 5% dextrose.<br>0.1 ml/hr will deliver 100 nanograms/kg/min.");$("#protine2").html(Math.round(150*a)/10+" micrograms added to 50 ml of 0.9% NaCl or 5% dextrose.<br>1 ml/hr will deliver 5 nanograms/kg/min.");1.5>a?($("#uvcdetails").html("<b>Size:</b> 3.5 F<br><b>Length:</b> "+Math.round(10*(1.5*a+5.5))/10+" cm (plus stump length)<br>L = (1.5 x birthweight [kg]) + 5.5"),$("#uvcdetails2").html("<b>Size:</b> 3.5 F<br><b>Length:</b> "+
Math.round(10*(1.5*a+5.5))/10+" cm (plus stump length)<br>L = (1.5 x birthweight [kg]) + 5.5")):($("#uvcdetails").html("<b>Size:</b> 5 F<br><b>Length:</b> "+Math.round(10*(1.5*a+5.5))/10+" cm (plus stump length)<br>L = (1.5 x birthweight [kg]) + 5.5"),$("#uvcdetails2").html("<b>Size:</b> 5 F<br><b>Length:</b> "+Math.round(10*(1.5*a+5.5))/10+" cm (plus stump length)<br>L = (1.5 x birthweight [kg]) + 5.5"));1.2>a?($("#uacdetails").html("<b>Size:</b> 3.5 F<br><b>Length:</b> "+Math.round(10*(3*a+9))/
10+" cm (plus stump length)<br>L = (birthweight [kg] x 3) + 9"),$("#uacdetails2").html("<b>Size:</b> 3.5 F<br><b>Length:</b> "+Math.round(10*(3*a+9))/10+" cm (plus stump length)<br>L = (birthweight [kg] x 3) + 9")):($("#uacdetails").html("<b>Size:</b> 5 F<br><b>Length:</b> "+Math.round(10*(3*a+9))/10+" cm (plus stump length)<br>L = (3 x birthweight [kg]) + 9"),$("#uacdetails2").html("<b>Size:</b> 5 F<br><b>Length:</b> "+Math.round(10*(3*a+9))/10+" cm (plus stump length)<br>L = (3 x birthweight [kg]) + 9"));
$("#fentanylbolus2").html(Math.round(5*a)+" micrograms by slow IV push<br>(preferred drug for intubation)");$("#morphinebolus2").text(Math.round(100*a)+" micrograms by slow IV push");$("#vecuroniumbolus").html(Math.round(100*a)+" micrograms by slow IV push<br>(for short duration of action)");$("#pancuroniumbolus").html(Math.round(100*a)+" micrograms by slow IV push<br>(for longer duration of action)");$("#morphinesedativeinfusion").text(Math.round(100*a)/100+" mg added to 50 ml of 0.9% NaCl or 5% Dextrose. 1 ml/hr will deliver 20 micrograms/kg/hr.");
$("#vecuroniumsedativeinfusion").text(Math.round(50*a)/10+" mg added to 50 ml of 0.9% NaCl or 5% Dextrose. 1 ml/hr will deliver 100 micrograms/kg/hr.");$("#phenobarbitoneloading").text(Math.round(200*a)/10+" mg given IV over 20 minutes");$("#phenytoinloading").html(Math.round(180*a)/10+" mg given IV over 30 min<br>(needs close ECG monitoring)");999>Math.round(300*a)?$("#diazepam").html(Math.round(300*a)+" micrograms<br>(given IV over 5 min)"):$("#diazepam").html(Math.round(300*a/1E3*10)/10+" mg<br>(given IV over 5 min)");
3.3>a?$("#midazolaminfusion").html(Math.round(150*a)/10+" mg added to 50 ml 0.9% NaCl or 5% dextrose.<br>0.1 ml/hr will deliver 30 micrograms/kg/hour."):$("#midazolaminfusion").html(Math.round(15*a/5*10)/10+" mg added to 50 ml 0.9% NaCl or 5% dextrose.<br>0.5 ml/hr will deliver 30 micrograms/kg/hour.");c=Math.round(1*a)/10;var d=Math.round(3*a)/10,n="",l="";.1>c&&(c=.1,n="<br>(minimum 0.1 ml)");.1>d&&(d=.1,l="<br>(minimum 0.1 ml)");var q=1.5<a?.4:.5;$("#adrenalineemergency").html("<b>1st dose</b> at 0.1 ml/kg<br>= "+
c+" ml IV stat."+n+"<br>Flush with 0.9% sodium chloride.<br><br><b>2nd dose</b> at 0.3 ml/kg<br>= "+d+" ml IV stat."+l+"<br>Flush with 0.9% sodium chloride.");$("#sodiumbicarb").html(Math.round(20*a)/10+" ml (="+Math.round(2*a/2*10)/10+' mmol) of sodium bicarbonate <span class="highlightdrug">4.2%</span> for use during emergency resuscitation, given via UVC');$("#sodiumbicarbhalfcorrection").html('<a href="#halfcorrection" data-transition="none" data-corners="false" style="text-decoration: none; color: rgb(52, 73, 94)">Base deficit (mmol/L) x '+
q+" x ["+Math.round(10*a)/10+" kg (weight)]. Only <b>half</b> the base deficit should be corrected initially by slow IV infusion (dilute sodium bicarbonate 4.2% with equal parts water and give over 30 minutes).</a>");$("#dextrosebolus").text(Math.round(25*a)/10+" ml over 20-30 minutes, via UVC or IV.");1E3>Math.round(150*a)?$("#adenosine").html(Math.round(150*a)+" micrograms IV stat into a large central vein and followed immediately by NaCl 0.9% push."):$("#adenosine").html(Math.round(150*a/1E3*100)/
100+" mg IV stat into a large central vein and followed immediately by NaCl 0.9% push.");$("#insulin").html(Math.round(20*a)/10+" units added to 20 ml 5% dextrose.<br>0.1 ml/hr will deliver 0.01 units/kg/hour, given IV as an infusion. Flush 5 ml through giving set before connecting.");$("#benpen").html(Math.round(50*a)+" mg IV (BD/TDS depending on age)");$("#gentamicin").html(Math.round(50*a)/10+" mg IV. Check level before 3rd dose.");$("#fluids").html(Math.round(600*a)/10+" ml daily over 24 hours<br>= "+
Math.round(60*a/24*10)/10+" ml/hour infusion");2.5<=a?$("#vitk").html("1 mg IM"):$("#vitk").html(Math.round(4*a)/10+" mg IM");$("#naclbolus2").text(Math.round(100*a)/10+" ml over 20-30 minutes");$("#dextrosebolus2").text(Math.round(25*a)/10+" ml over 20-30 minutes");var e=$("#fluidsvalue").val(),f=$("#dextrosefluid").val(),g=$("#tisodium").val();c=$("#tipotassium").val();d="";void 0==g&&(g="");void 0==c&&(c="");12.5<f?($("#dextrosefluid-label").html('Dextrose: (%) <span style="color: #990000">- NB Central Access Required</style>'),
d='<b>Administration route</b><br>Infuse via <span style="color: #990000">central line</span> <span class="greytext">(dextrose concentration > 12.5%)</span>.<br><br>'):$("#dextrosefluid-label").html("Dextrose: (%)");4.8<c&&(d='<b>Administration route</b><br>Infuse via <span style="color: #990000">central line</span> <span class="greytext">(potassium infusion rate > 0.2 mmol/kg/hr; maximum rate 0.5 mmol/kg/hr centrally - Evelina Children\'s Hospital Formulary)</span>.<br><br>');4.8<c&&12.5<f&&(d='<b>Administration route</b><br>Infuse via <span style="color: #990000">central line</span> <span class="greytext">(Dextrose > 12.5% AND potassium infusion rate > 0.2 mmol/kg/hr; maximum potassium rate 0.5 mmol/kg/hr centrally - Evelina Children\'s Hospital Formulary)</span>.<br><br>');
""==e?$("#fluidcontainer").hide():$("#fluidcontainer").show();if(""!=a&&""!=e){var h=Number(e)*Number(a),k=h/24;h=Math.round(10*h)/10;k=Math.round(10*k)/10;var p=k*f*1E3/(6E3*a);4>h?$("#fluidoutput").html("<b>Daily total fluid requirement</b><br>= This amount of fluid is lower than usually given on NICU. Please check the fluid amount carefully above.<br><br>"):$("#fluidoutput").html("<b>Daily total fluid requirement</b><br>= "+h+" ml/day, or "+k+' ml/hour.<br><span class="greytext">= '+Math.round(10*
p)/10+' mg/kg/min glucose infusion rate</span> <a href="#gir" data-transition="none" data-corners="false"><img src="images/question50px.png" class="infobtn" /></a><br><br>'+d)}if(""!=f)if(5>f&&2<f||30<f)showMessage("Please use a dextrose % concentration between 5 - 30%.",b,"Dextrose error","Done"),console.log("Dextrose error");else{if(250<e)throw console.log("Volume error"),$("#fluidoutput").html($("#fluidsvalue").val()+" ml/kg/day is more than usually recommended in a newborn. Please check and try again."),
showMessage("This amount of fluid is probably too much for normal neonatal care. Please check and try again.",b,"Fluid volume error","Done"),"Fluid volume too great for normal practice";5==f||10==f?("Please enter your baby's details to the left to get started."==$("#fluidoutput").html()&&$("#fluidoutput").html(""),$("#fluidoutput").html($("#fluidoutput").html()+"<b>Preparation</b><br>Take a 500ml bag of "+f+"% dextrose. ")):10>f?(d=(50-f)/45,$("#fluidoutput").html($("#fluidoutput").html()+"<b>Preparation</b><br>Take a 500ml bag of 5% dextrose, remove "+
Math.round(5E3*(1-d))/10+" ml and add "+Math.round(5E3*(1-d))/10+" ml of 50% dextrose. ")):(d=(50-f)/40,$("#fluidoutput").html($("#fluidoutput").html()+"<b>Preparation</b><br>Take a 500ml bag of 10% dextrose, remove "+Math.round(5E3*(1-d))/10+" ml and add "+Math.round(5E3*(1-d))/10+" ml of 50% dextrose. "))}(0<g||0<c)&&$("#fluidoutput").html($("#fluidoutput").html()+"Add:");0<g&&""!=e&&(d=g/e*500-15.4,varifdexsalinemsg=14.5<Math.round(g/e*5E3)/10&&16>Math.round(g/e*5E3)/10?'<br><div style="font-size: 12px; line-height: 13px; padding-left: 1.2em;">(or consider just using 10% dextrose + 0.18% saline, as a bag already contains 15.4 mmol sodium)</div>':
0<d?'<br><div style="font-size: 12px; line-height: 13px; padding-left: 1.2em;">(or add '+Math.round(10*d)/10+" mmol NaCl if using 10% dextrose + 0.18% saline, as a bag already contains 15.4 mmol sodium)</div>":"",$("#fluidoutput").html($("#fluidoutput").html()+"<li>"+Math.round(g/e*5E3)/10+" mmol sodium chloride"+varifdexsalinemsg+'<a href="#popadditives" data-transition="none" data-corners="false"><img src="images/question50px.png" class="infobtn" /></a></li>'));0<c&&""!=e&&$("#fluidoutput").html($("#fluidoutput").html()+
"<li>"+Math.round(c/e*5E3)/10+" mmol potassium chloride</li>");1<c&&.5<c/h&&$("#fluidoutput").html("<b>WARNING: </b> Potassium concentration in this fluid exceeds the maximum of 0.5 mmol/ml (Evelina Children's Hospital Formulary). <br><br>Please either reduce the amount of potassium or increase the daily fluid.");.4>a?($(".outputvalue").each(function(){$(this).text("Enter weight")}),$("#fluidoutput").html("Please enter a valid weight at the top to get started.")):($("#babyweight").parent().removeClass("texthighlight"),
$("#babyweight").parent().removeClass("flash"),$(".infobtn").show());$(document).on("pageshow","#gir",function(){$("#gir-rate").text(k);$("#gir-dexconc").text(f);$("#gir-weight").text(a);$("#gir-answer").text(Math.round(10*p)/10)});$(document).on("pageshow","#popadditives",function(){$("#popadditives-naamount").text(g);$("#popadditives-fluidrate").text(e);$("#popadditives-answer").text(Math.round(g/e*5E3)/10)})},Infusion=function(b,a,c,d,n,l,q,e,f,g,h,k,p,t,u,v){this.drugname=b;this.deliverydose=
a;this.deliveryunits=c;this.deliveryunitsfull=c.replace("mcg/","micrograms/").replace("ng/","nanograms/");this.desiredrate=d;this.weight=n;this.syringe=l;this.fluidtype=q;this.drugdosemsg=f;this.minconc=g;this.maxconc=h;this.minconcmsg=k;this.maxconcmsg=p;this.mindose=t;this.maxdose=u;this.referenceunits=v;""==this.referenceunits&&(this.referenceunits=this.deliveryunits);console.log("Desired rate: "+this.desiredrate);console.log("Minimum dose: "+this.mindose);this.error=0;if(""==this.weight||0==this.weight)if(this.weight=
$("#babyweight").val(),""==this.weight||0==this.weight)this.error="No weight specified",console.log(this.error);this.fluidtypetext=function(){switch(this.fluidtype){case "5d0.9ns":return"0.9% NaCl or 5% dextrose";case "10d0.9ns":return"0.9% NaCl or 5% dextrose"}};var m=this.deliveryunits.split("/");this.deliveryunitsarray=m;this.deliveryunitsdrug=function(){switch(m[0]){case "g":return 1;case "mg":return.001;case "milligrams":return.001;case "mcg":return 1E-6;case "micrograms":return 1E-6;case "ng":return 1E-9;
case "nanograms":return 1E-9}};this.deliveryunitsdrugtext=m[0];this.deliveryunitstime=function(){switch(m[2]){case "min":return 60;case "hr":return 1;case "day":return 1/24}};this.deliveryunitstimetext=m[2];var r=this.referenceunits.split("/");this.referenceunitsarray=r;this.referenceunitsdrug=function(){switch(r[0]){case "g":return 1;case "mg":return.001;case "milligrams":return.001;case "mcg":return 1E-6;case "micrograms":return 1E-6;case "ng":return 1E-9;case "nanograms":return 1E-9}};this.referenceunitstime=
function(){switch(r[2]){case "min":return 60;case "hr":return 1;case "day":return 1/24}};b=this.deliveryunitsdrug()*this.deliveryunitstime();a=this.referenceunitsdrug()*this.referenceunitstime();this.desiredratefactor=function(){return 1*this.deliveryunitsdrug()*this.deliveryunitstime()};this.drugtotalmg=function(){return this.weight/1E3*1E3*this.deliverydose*this.desiredratefactor()*this.syringe/this.desiredrate};this.drugtotal=function(){return 1E3<=this.drugtotalmg()?Math.round(this.drugtotalmg()/
1E3*100)/100+" g":.5>this.drugtotalmg()?Math.round(1E3*this.drugtotalmg())+" micrograms":.5<=this.drugtotalmg()&&1>this.drugtotalmg()?Math.round(100*this.drugtotalmg())/100+" mg":1<=this.drugtotalmg()&&100>this.drugtotalmg()?Math.round(10*this.drugtotalmg())/10+" mg":Math.round(1*this.drugtotalmg())/1+" mg"};this.advisoryoverride=this.advisoryerror=0;this.advisorymsg="";console.log("Reference units: "+this.referenceunits+" ("+a+"), current units: "+this.deliveryunits+" ("+b+")");this.deliverydose*
b>this.maxdose*a&&(this.advisoryoverride=this.advisoryerror=1,this.advisorymsg=this.advisorymsg+"Maximum suggested dosage ("+this.maxdose+" "+this.referenceunits+") exceeded. ");Math.round(this.deliverydose*b*1E10)/1E10<Math.round(this.mindose*a*1E10)/1E10&&(this.advisoryoverride=this.advisoryerror=1,this.advisorymsg=this.advisorymsg+"Dosage less than recommended minimum ("+this.mindose+" "+this.referenceunits+"). ");this.drugtotalmg()>this.maxconc&&(this.advisoryerror=1,""==this.maxconcmsg&&(this.maxconcmsg=
"Infusion concentration is higher than recommended."),0==Math.round(this.drugtotalmg()/this.syringe*10)/10?this.advisorymsg=this.advisorymsg+"Infusion concentration is "+Math.round(1E3*this.drugtotalmg()/this.syringe*10)/10+" mcg/ml. "+this.maxconcmsg:this.advisorymsg=this.advisorymsg+"Infusion concentration is "+Math.round(this.drugtotalmg()/this.syringe*10)/10+" mg/ml. "+this.maxconcmsg);this.drugtotalmg()<this.minconc&&(this.advisoryerror=1,""==this.minconcmsg&&(this.minconcmsg="Infusion concentration is lower than recommended."),
this.advisorymsg+=this.minconcmsg);.001>this.drugtotalmg()&&(this.advisoryerror=1,console.log("Drug total is 0 - WARNING!"),this.advisorymsg+="Drug dose added to syringe is probably too small. Please check your entry carefully.");this.outputtext=function(){var a=this.drugtotal()+" added to "+this.syringe+" ml of "+this.fluidtypetext()+". <br>"+this.desiredrate+" ml/hr will deliver "+this.deliverydose+" "+this.deliveryunitsfull+".";1==this.advisoryoverride&&(a="Please correct critical errors:");1==
this.advisoryerror&&(a=a+'<br><div id="advisorymsg"><strong>WARNING: </strong>'+this.advisorymsg+"</div>");return 0!=this.error?this.error:a};console.log("Popup: "+e);1==e&&($("form :input").unbind(),$("#fdeliverydose").unbind(),$.mobile.changePage("#infusion-detail",{role:"",transition:"none",corners:!1}),$("#infusionheader").text(this.drugname),$("#infusionoutputtext").html(this.outputtext()),console.log("Popup 1: "+this.outputtext()),$("#fdeliverydose").val(this.deliverydose),$("#fdeliveryunitsdrug").val(this.deliveryunitsdrugtext).selectmenu("refresh"),
$("#fdeliveryunitstime").val(this.deliveryunitstimetext).selectmenu("refresh"),$("#fdesiredrate").val(this.desiredrate).slider("refresh"),$("#fsyringe").val(this.syringe).slider("refresh"),$("#ffluidtype").val(this.fluidtype),$("#fusualdose").html(this.drugdosemsg),$("#infusion-detail").find(".maintitle-weight").text("(for a "+$("#babyweight").val()/1E3+" kg baby)"));2==e&&($("#infusionoutputtext").html(this.outputtext()),console.log("Popup 2: "+this.outputtext()));return this.drugtotal()};
$(document).ready(function(){$(".infusion-detail").parent().click(function(){"generic"!=$(this).find(".infusion-detail").data("infusion-drugname")&&$(this).find(".infusion-detail").trigger("click");event.stopPropagation()});$(".infusion-detail").click(function(b){var a=function(a){return infusiondb.filter(function(b){return b.name==a})[0]};if(""==$("#babyweight").val())return console.log("Navigator alert called"),showMessage("Please enter the baby's weight first.",highlightWeight,"Missing Weight",
"Done"),b.stopPropagation(),!1;if(400>$("#babyweight").val()||7E3<$("#babyweight").val())return console.log("Navigator alert called"),showMessage("Please check your baby's weight - this app is only suitable for babies on NICU.",highlightWeight,"Incorrect weight","Done"),b.stopPropagation(),!1;var c=$(this).parent().data("infusion-drugname");void 0==c&&(c=$(this).data("infusion-drugname"));b=new a(c);console.log("Drug selected "+b.name);var d=new Infusion(b.name,b.startdose,b.units,b.desiredrate,0,
b.syringe,b.fluidtype,1,b.dosemsg,b.minconc,b.maxconc,b.minconcmsg,b.maxconcmsg,b.mindose,b.maxdose,b.units);console.log(d.outputtext());trackPage("infusion-"+b.name);$("form :input").unbind();$("#fdeliverydose").unbind();$("form :input").change(function(){console.log("New calculation");var b=new a(c);new Infusion(b.name,$("#fdeliverydose").val(),$("#fdeliveryunitsdrug").val()+"/kg/"+$("#fdeliveryunitstime").val(),$("#fdesiredrate").val(),0,$("#fsyringe").val(),$("#ffluidtype").val(),2,b.dosemsg,
b.minconc,b.maxconc,b.minconcmsg,b.maxconcmsg,b.mindose,b.maxdose,b.units);$("#fdeliveryunitsdrug").selectmenu("refresh");$("#fdeliveryunitstime").selectmenu("refresh")});$("#fdeliverydose").keyup(function(){var b=new a(c);new Infusion(b.name,$("#fdeliverydose").val(),$("#fdeliveryunitsdrug").val()+"/kg/"+$("#fdeliveryunitstime").val(),$("#fdesiredrate").val(),0,$("#fsyringe").val(),$("#ffluidtype").val(),2,b.dosemsg,b.minconc,b.maxconc,b.minconcmsg,b.maxconcmsg,b.mindose,b.maxdose,b.units);console.log("New calculation")});
return!1})});